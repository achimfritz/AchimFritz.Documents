<toaster-container></toaster-container>

<overlay finished="finished"></overlay>
<div data-ng-if="!finished" class="spinner">
	<spinner></spinner>
</div>

    <nav class="navbar navbar-default navbar-static">
      <div class="container-fluid">
        <div class="navbar-header">
          <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target=".bs-example-js-navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar">a</span>
            <span class="icon-bar">b</span>
            <span class="icon-bar"></span>
          </button>
			<span class="navbar-brand">MP3</span>
          
        </div>


        <div class="collapse navbar-collapse bs-example-js-navbar-collapse">
          <ul class="nav navbar-nav">
				 <li class="dropdown" ng-repeat="(facet, result) in data.facet_counts.facet_fields" ng-hide="facet == 'artist' || facet == 'album' || facet == 'artistLetter'">
					<a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" role="button" aria-expanded="false">
						{{facet}}
						<span class="caret"></span>
					</a>
					<ul class="dropdown-menu" role="menu" aria-labelledby="drop1">
						<li role="presentation" ng-repeat="(key, value) in result">
							<a href="javascript:void" ng-click="addFilterQuery(facet, key)">
								<nav-path ng-attr-path="{{key}}" ng-attr-facet="{{facet}}" ></nav-path>
								({{value}}) 
							</a>
						</li>
					</ul>
				</li>
				<li>
					<form novalidate class="navbar-form navbar-left navbar-input-group" ng-submit="update(search)" >
						<div class="form-group">
							<label class="control-label" for="search">search: </label>
							<input class="form-control" id="search" type="text" data-autocomplete data-ng-model="search" />
						</div>
						<div class="form-group">
							<label class="control-label" for="submit">&nbsp;</label>
							<input type="submit" id="submit" value="Submit" class="form-control btn btn-default" />
						</div>
						<div class="form-group">
							<label class="control-label" for="rows">rows: </label>
							<input type="text" class="form-control" id="rows" data-ng-model="settings.rows" ng-change="update()" />
						</div>
						<div class="form-group">
							<label class="control-label" for="facet_limit">facet.limit: </label>
							<input type="text" class="form-control" id="facet_limit" data-ng-model="settings.facet_limit" ng-change="update()" />
						</div>
						<div class="form-group">
							<label class="control-label" for="sort">sort: </label>
							<select class="form-control" id="sort" data-ng-model="settings.sort" ng-change="update()">
								<option value="artist asc, album asc, track asc">Artist, Album, Track</option>
								<option value="track asc">track asc</option>
								<option value="track desc">track desc</option>
								<option value="artist asc">artist asc</option>
							</select>
						</div>
					</div>
				</li>
         </ul>
        </div><!-- /.nav-collapse -->
      </div><!-- /.container-fluid -->
    </nav> <!-- /navbar-example -->

		<div class="row">
		  <div class="col-md-12">
				<div class="btn-group" role="group" aria-label="filter">
					<span>
						<button role="button" class="btn btn-danger btn-xs" ng-click="selectLetter(null)">
							<span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
						</button>
					</span>
					<span ng-repeat="(key, value) in letterNav">
						<button role="button" class="btn btn-default btn-xs" ng-click="selectLetter(key)">
							<nav-path ng-attr-path="{{key}}" ng-attr-facet="artistLetter" ></nav-path>
							({{value}}) 
						</button>
					</span>
				</div>
		  </div>
		</div>
		<div class="row">
		  <div class="col-md-12">
				<div class="btn-group" role="group" aria-label="filter">
					<span ng-repeat="(key, values) in filterQueries">
						<button role="button" class="btn btn-default btn-danger" ng-click="rmFilterQuery(key, value)" ng-repeat="value in values" ng-hide="key == 'artistLetter'">
							<span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
							{{key}}
							<filter-query ng-attr-path="{{value}}" ng-attr-facet="{{key}}"></filter-query> 
						</button>
					</span>
				</div>
			</div>
		</div>

		<div class="row">
		  <div class="col-md-2" ng-hide="infoDoc">
				<ul ng-hide="hideArtists">
					<li ng-repeat="(key, value) in data.facet_counts.facet_fields.artist" ng-click="addFilterQuery('artist', key)">
						<nav-path ng-attr-path="{{key}}" ng-attr-facet="artist" ></nav-path>
						({{value}}) 
					</li>
				</ul>
				<ul ng-show="showAlbums">
					<li ng-repeat="(key, value) in data.facet_counts.facet_fields.album" ng-click="addFilterQuery('album', key)">
						<nav-path ng-attr-path="{{key}}" ng-attr-facet="album" ></nav-path>
						({{value}}) 
					</li>
				</ul>
			</div>
		  <div class="col-md-2" ng-show="infoDoc">
			<button type="button" class="close" aria-label="Close" ng-click="hideInfo()"><span aria-hidden="true">&times;</span></button>
						<table class="table table-striped">
							<tr>
								<td>
									Title
								</td>
								<td>
									{{infoDoc.title}}
								</td>
							</tr>
							<tr>
								<td>
									Track
								</td>
								<td>
									{{infoDoc.track}}
								</td>
							</tr>
							<tr>
								<td>
									Artist
								</td>
								<td>
									{{infoDoc.artist}}
								</td>
							</tr>
							<tr>
								<td>
									Album
								</td>
								<td>
									<span ng-show="infoDoc.album" editable-text="infoDoc.album" onaftersave="updateId3Tag($data, 'album', infoDoc.identifier)">{{infoDoc.album}}</span>
									<span ng-hide="infoDoc.album" editable-text="infoDoc.fsAlbum" onaftersave="updateId3Tag($data, 'album', infoDoc.identifier)">{{infoDoc.fsAlbum}}</span>
									<strong ng-hide="infoDoc.album" class="text-danger">!</strong>
								</td>
							</tr>
							<tr>
								<td>
									Genre
								</td>
								<td>
									 {{infoDoc.genre}} / {{infoDoc.genreId}}
								</td>
							</tr>
						</table>
						<table class="table table-striped">
							<tr>
								<td>Provider</td>
								<td>
									 {{infoDoc.fsProvider}}
								</td>
							</tr>
							<tr>
								<td>
									fsTitle
								</td>
								<td>
									{{infoDoc.fsTitle}}
								</td>
							</tr>
							<tr>
								<td>
									fsTrack
								</td>
								<td>
									{{infoDoc.fsTrack}}
								</td>
							</tr>
							<tr>
								<td>
									fsArtist
								</td>
								<td>
									{{infoDoc.fsArtist}}
								</td>
							</tr>
							<tr>
								<td>
									fsAlbum
								</td>
								<td>
									{{infoDoc.fsAlbum}}
								</td>
							</tr>
							<tr>
								<td>
									fsGenre
								</td>
								<td>
									{{infoDoc.fsGenre}}
								</td>
							</tr>
						</table>

		  </div>
        <div class="col-md-6">
				<div class="row">
					<div class="col-md-12">
						found {{data.response.numFound}} (displaying {{settings.rows}})
						<dir-pagination-controls on-page-change="nextPage(newPageNumber)"></dir-pagination-controls>
						<button class="btn btn-default" play-all="songs" my-playlist="playlist">
							<span class="glyphicon glyphicon-play" aria-hidden="true"></span>Play All
						</button>
						<button class="btn btn-default" play-all="songs" my-playlist="playlist" data-play="false">
							<span class="glyphicon glyphicon-plus" aria-hidden="true"></span>Add All
						</button>
					</div>
				</div>
				<div class="row">
					<div class="col-md-12">
						<table class="table table-striped">
							<tr dir-paginate="song in songs | itemsPerPage: settings.rows" total-items="data.response.numFound" current-page="settings.start / settings.rows + 1" >
								<td>
									<button class="btn btn-default btn-xs" music-player="play" add-song="song">
											<span class="glyphicon glyphicon-play" aria-hidden="true" ></span>
									</button>
									<button class="btn btn-default btn-xs" music-player add-song="song">
										  <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
									</button>
									<button class="btn btn-default btn-xs" ng-click="showInfo(song.doc)">
										<span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>
									</button>
								</td>
								<td>
									<span ng-show="song.doc.artist" editable-text="song.doc.artist" onaftersave="updateId3Tag($data, 'artist', song.doc.identifier)">{{song.doc.artist}}</span>
									<span ng-hide="song.doc.artist" editable-text="song.doc.fsArtist" onaftersave="updateId3Tag($data, 'artist', song.doc.identifier)">{{song.doc.fsArtist}}</span>
									<strong ng-hide="song.doc.artist" class="text-danger">!</strong>
								</td>
								<td>
									<span ng-show="song.doc.album" editable-text="song.doc.album" onaftersave="updateId3Tag($data, 'album', song.doc.identifier)">{{song.doc.album}}</span>
									<span ng-hide="song.doc.album" editable-text="song.doc.fsAlbum" onaftersave="updateId3Tag($data, 'album', song.doc.identifier)">{{song.doc.fsAlbum}}</span>
									<strong ng-hide="song.doc.album" class="text-danger">!</strong>
								</td>
								<td>
									<span ng-show="song.doc.title" editable-text="song.doc.title" onaftersave="updateId3Tag($data, 'title', song.doc.identifier)">{{song.doc.title}}</span>
									<span ng-hide="song.doc.title" editable-text="song.doc.fsTitle" onaftersave="updateId3Tag($data, 'title', song.doc.identifier)">{{song.doc.fsTitle}}</span>
									<strong ng-hide="song.doc.title" class="text-danger">!</strong>
								</td>
							</tr>
						</table>
					</div>
				</div>
        </div>


        <div class="col-md-4">
            <!-- init soundManager2 player -->
            <sound-manager></sound-manager>
				<div class="row form-group" ng-show="form === 'edit'">
					<div class="col-md-6">
						<input class="form-control" id="tagPath" type="text" data-ng-model="tagPath" data-autocomplete data-global="true" />
					</div>
					<div class="col-md-3">
						<input class="form-control btn btn-danger" type="submit" ng-click="writeTag()" value="write Id3 Tag" />
					</div>
					<div class="col-md-2">
						<input class="form-control btn btn-danger" type="submit" ng-click="showForm('')" value="Cancel" />
					</div>
				</div>
				<div class="row form-group" ng-show="form === 'zip'">
					<div class="col-md-4">
						<input class="form-control" type="text" data-ng-model="zip.name" />
					</div>
					<div class="col-md-2 checkbox">
						<label>
							<input type="checkbox" value="1" data-ng-model="zip.useFullPath" />Full Path
						</label>
					</div>
					<div class="col-md-3">
						<input class="form-control btn btn-danger" type="submit" ng-click="zipDownload()" value="Zip Download" />
					</div>
					<div class="col-md-2">
						<input class="form-control btn btn-danger" type="submit" ng-click="showForm('')" value="Cancel" />
					</div>
				</div>

				
				<div class="row">
					<div class="col-md-12">
						<button play-music class="btn btn-default"><span class="glyphicon glyphicon-play" aria-hidden="true"></span></button>
						<button pause-music class="btn btn-default"><span class="glyphicon glyphicon-pause" aria-hidden="true"></span></button>
						<button stop-music class="btn btn-default"><span class="glyphicon glyphicon-stop" aria-hidden="true"></span></button>
						<button prev-track class="btn btn-default"><span class="glyphicon glyphicon-backward" aria-hidden="true"></span></button>
						<button next-track class="btn btn-default"><span class="glyphicon glyphicon-forward" aria-hidden="true"></span></button>
						<button ng-show="repeat == false" repeat-music class="btn btn-default"><span class="glyphicon glyphicon-repeat" aria-hidden="true"></span></button>
						<button ng-show="repeat == true" repeat-music class="btn btn-primary"><span class="glyphicon glyphicon-repeat" aria-hidden="true"></span></button>
						<button clear-playlist class="btn btn-default"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></button>
						Volume: {{ volume }}
						<button music-volume data-type="increase" class="btn btn-default"><span class="glyphicon glyphicon-volume-up" aria-hidden="true"></span></button>
						<button music-volume data-type="decrease" class="btn btn-default"><span class="glyphicon glyphicon-volume-down" aria-hidden="true"></span></button>
						<button ng-show="mute== false" mute-music class="btn btn-default"><span class="glyphicon glyphicon-volume-off" aria-hidden="true"></span></button>
						<button ng-show="mute== true" mute-music class="btn btn-primary"><span class="glyphicon glyphicon-volume-off" aria-hidden="true"></span></button>
						<button class="btn btn-danger" ng-click="showForm('zip')">
							<span class="glyphicon glyphicon-download" aria-hidden="true"></span>
						</button>
						<button class="btn btn-danger" ng-click="showForm('edit')">
							<span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
						</button>
					</div>
				</div>

				<div class="row" ng-show="currentPlaying && playlist.length && currentPlaying.doc.webThumbPath">
					<div class="col-md-12">
                        <img ng-src="{{currentPlaying.doc.webThumbPath}}" alt="{{currentPlaying.title}}" />
                    </div>
               </div>
				<div class="row form-group" ng-show="currentPlaying && playlist.length">
					<div class="col-md-4">
                     Track: 
                        <button ng-click="rate('track', 1, currentPlaying)" class="btn btn-xs btn-default">1</button>
                        <button ng-click="rate('track', 2, currentPlaying)" class="btn btn-xs btn-default">2</button>
                        <button ng-click="rate('track', 3, currentPlaying)" class="btn btn-xs btn-default">3</button>
                        <button ng-click="rate('track', 4, currentPlaying)" class="btn btn-xs btn-default">4</button>
                        <button ng-click="rate('track', 5, currentPlaying)" class="btn btn-xs btn-default">5</button>
                        <button ng-click="rate('track', 6, currentPlaying)" class="btn btn-xs btn-default">6</button>
                    </div>
					<div class="col-md-4">
                     Artist: 
                        <button ng-click="rate('artist', 1)" class="btn btn-xs btn-default">1</button>
                        <button ng-click="rate('artist', 2)" class="btn btn-xs btn-default">2</button>
                        <button ng-click="rate('artist', 3)" class="btn btn-xs btn-default">3</button>
                        <button ng-click="rate('artist', 4)" class="btn btn-xs btn-default">4</button>
                        <button ng-click="rate('artist', 5)" class="btn btn-xs btn-default">5</button>
                        <button ng-click="rate('artist', 6)" class="btn btn-xs btn-default">6</button>
                    </div>
					<div class="col-md-4">
                     Artist: 
                        <button ng-click="rate('artist', 1)" class="btn btn-xs btn-default">1</button>
                        <button ng-click="rate('artist', 2)" class="btn btn-xs btn-default">2</button>
                        <button ng-click="rate('artist', 3)" class="btn btn-xs btn-default">3</button>
                        <button ng-click="rate('artist', 4)" class="btn btn-xs btn-default">4</button>
                        <button ng-click="rate('artist', 5)" class="btn btn-xs btn-default">5</button>
                        <button ng-click="rate('artist', 6)" class="btn btn-xs btn-default">6</button>
                    </div>
               </div>
				<div class="row" ng-show="currentPlaying && playlist.length">
					<div class="col-md-6">
						<table class="table table-striped">
							<tr>
								<td>Playing</td>
								<td>
									({{ currentPostion }} / {{ currentDuration }})
								</td>
							</tr>
							<tr>
								<td>
									Title
								</td>
								<td>
									{{currentPlaying.title}}
								</td>
							</tr>
							<tr>
								<td>
									Track
								</td>
								<td>
									{{currentPlaying.doc.track}}
								</td>
							</tr>
							<tr>
								<td>
									Artist
								</td>
								<td>
									{{currentPlaying.doc.artist}}
								</td>
							</tr>
							<tr>
								<td>
									Album
								</td>
								<td>
									{{currentPlaying.doc.album}}
								</td>
							</tr>
							<tr>
								<td>
									Genre
								</td>
								<td>
									 {{currentPlaying.doc.genre}} / {{currentPlaying.doc.genreId}}
								</td>
							</tr>
						</table>
					</div>
					<div class="col-md-6">
						<table class="table table-striped">
							<tr>
								<td>Provider</td>
								<td>
									 {{currentPlaying.doc.fsProvider}}
								</td>
							</tr>
							<tr>
								<td>
									fsTitle
								</td>
								<td>
									{{currentPlaying.doc.fsTitle}}
								</td>
							</tr>
							<tr>
								<td>
									fsTrack
								</td>
								<td>
									{{currentPlaying.doc.fsTrack}}
								</td>
							</tr>
							<tr>
								<td>
									fsArtist
								</td>
								<td>
									{{currentPlaying.doc.fsArtist}}
								</td>
							</tr>
							<tr>
								<td>
									fsAlbum
								</td>
								<td>
									{{currentPlaying.doc.fsAlbum}}
								</td>
							</tr>
							<tr>
								<td>
									fsGenre
								</td>
								<td>
									{{currentPlaying.doc.fsGenre}}
								</td>
							</tr>
						</table>
					</div>
				</div>
				<div class="row">
					<div class="col-md-12">
						<table set-playlist class="table">
							<tr ng-repeat="song in playlist" ng-class="{true: 'alert alert-info'}[currentPlaying.id == song.id]">
								<td>
									<button play-from-playlist="song" class="btn btn-default btn-xs">
										<span class="glyphicon glyphicon-play" aria-hidden="true"></span>
									</button>
									<button class="btn btn-default btn-xs" remove-from-playlist="song" data-index="{{$index}}">
										<span class="glyphicon glyphicon-minus" aria-hidden="true"></span>
									</button>
								</td>
								<td>
									{{song.title}}
								</td>
							</tr>
						</table>
					</div>
				</div>
        </div>
    </div>


<toaster-container></toaster-container>

<overlay finished="finished"></overlay>
<div data-ng-if="!finished" class="spinner">
	<spinner></spinner>
</div>

<div class="container" ng-show="view === 'list'">
	<div class="row">
		<div class="col-md-2">
			<input class="form-control" ng-model="search" type="text" />
		</div>
		<div class="col-md-2">
			<button class="btn btn-default " ng-show="showAll === false" ng-click="setShowAll(true)">show all</button>
			<button class="btn btn-default " ng-show="showAll === true" ng-click="setShowAll(false)">hide non differs</button>
		</div>
	</div>

	<div class="row">
		<div class="col-md-12">
			<table class="table table-striped">
				<tr ng-repeat="integrity in integrities | filter:search" ng-show="integrity.countDiffers || showAll">
					<td>{{integrity.name}}</td>
					<td>{{integrity.countFileSystem}}</td>
					<td>{{integrity.countSolr}}</td>
					<td ng-click="show(integrity.name)"><button class="btn btn-default btn-xs" >show</button></td>
				</tr>
			</table>
		</div>
	</div>
</div>

<div ng-show="view === 'show'">
	<div class="row">
		<div class="col-md-4">
			<h4>{{integrity.name}}</h4>
		</div>
		<div class="col-md-2">
			<button ng-click="list()" class="btn btn-default" >list</button>
		</div>
		<div class="col-md-2">
			<button ng-click="update(integrity.name)" class="btn btn-default btn-danger" >index</button>
			<button ng-hide="integrity.countDiffers" ng-click="solr(integrity.name)" class="btn btn-default btn-danger" >solr</button>
			<button ng-show="integrity.countDiffers" ng-click="initialize(integrity.name, 1)" class="btn btn-default btn-danger" >initialize exif</button>
			<button ng-show="integrity.countDiffers" ng-click="initialize(integrity.name, 0)" class="btn btn-default btn-danger" >initialize no exif</button>
		</div>
		<div class="col-md-1">
			<div ng-show="job">Job Status: {{job.status}}</div>
		</div>
	</div>
	<div class="row" ng-show="job">
		<div class="col-md-10">
			<pre>
				{{job.log}}
			</pre>
		</div>
	</div>
	<div class="row">
		<div class="col-md-3">
			<h4>Persisted</h4>
			<ul>
				<li ng-repeat="document in integrity.persistedDocuments">{{document.fileName}}</li>
			</ul>
		</div>
		<div class="col-md-3">
			<h4>Solr</h4>
			<ul>
				<li ng-repeat="document in integrity.solrDocuments">{{document}}</li>
			</ul>
		</div>
		<div class="col-md-3">
			<h4>FileSystem</h4>
			<ul>
				<li ng-repeat="document in integrity.filesystemDocuments">{{document}}</li>
			</ul>
		</div>
		<div class="col-md-3">
			<h4>Thumbs</h4>
			<ul>
				<li ng-repeat="document in integrity.thumbs">{{document}}</li>
			</ul>
		</div>
	</div>
</div>
